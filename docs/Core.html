<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Core - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Tutorials</li><li class="nav-item"><a href="tutorial-heroku-deploy-guide.html">Heroku Deploy Guide</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="API.html">API</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="API.html#_checkPermissions">_checkPermissions</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="API.html#_processQueue">_processQueue</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="API.html#call">call</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="API.html#scheduleCall">scheduleCall</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="API.html#send">send</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Bot.html">Bot</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Bot.html#start">start</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Button.html">Button</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Context.html">Context</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Context.html#attach">attach</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Context.html#clear">clear</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Context.html#keyboard">keyboard</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Context.html#noAutoSend">noAutoSend</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Context.html#removeKeyboard">removeKeyboard</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Context.html#send">send</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Context.html#setPid">setPid</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Context.html#text">text</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Core.html">Core</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Core.html#_escapeRegex">_escapeRegex</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Core.html#_event">_event</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Core.html#_generateHelpMessage">_generateHelpMessage</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Core.html#_isLocked">_isLocked</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Core.html#_registerMessageNewHandler">_registerMessageNewHandler</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Core.html#_tryHandleCommand">_tryHandleCommand</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Core.html#_tryHandlePayload">_tryHandlePayload</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Core.html#_tryHandleRegex">_tryHandleRegex</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Core.html#cmd">cmd</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Core.html#help">help</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Core.html#lock">lock</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Core.html#noEventWarnings">noEventWarnings</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Core.html#on">on</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Core.html#parseRequest">parseRequest</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Core.html#payload">payload</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Core.html#regex">regex</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Keyboard.html">Keyboard</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-log-LogMessageBuilder.html">LogMessageBuilder</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-log-LogMessageBuilder.html#_log">_log</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-log-LogMessageBuilder.html#e">e</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-log-LogMessageBuilder.html#from">from</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-log-LogMessageBuilder.html#i">i</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-log-LogMessageBuilder.html#now">now</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-log-LogMessageBuilder.html#r">r</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-log-LogMessageBuilder.html#text">text</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-log-LogMessageBuilder.html#type">type</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-log-LogMessageBuilder.html#w">w</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Stats.html">Stats</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Stats.html#event">event</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Stats.html#getEventCount">getEventCount</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Stats.html#print">print</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Stats.html#sent">sent</a></span></li><li class="nav-heading">Modules</li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-log.html">log</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-log.html#.requireFunction">requireFunction</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-log.html#.requireParam">requireParam</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-log.html#~log">log</a></span></li><li class="nav-heading"><a href="global.html">Globals</a></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#bot">bot</a></span></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#colors">colors</a></span></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#vk">vk</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">Core</h1>
    

    




<section>

<header>
    
        <h2>
        Core
        </h2>
        
            <div class="class-description"><p><code>Core</code> dispatches message handling to appropriate handlers,
and is used for setting these handlers.</p>
<p>Handlers for the <code>message_new</code> event will be searched in this order:</p>
<ol>
<li>If service action message =&gt; <a href="Core.html#on"><code>Core#on</code></a> handler for the <code>service_action</code> event</li>
<li>If user pressed the <code>Start</code> button =&gt; <a href="Core.html#on"><code>Core#on</code></a> handler for the <code>start</code> event</li>
<li><a href="Core.html#payload"><code>Core#payload</code></a></li>
<li><a href="Core.html#cmd"><code>Core#cmd</code></a></li>
<li><a href="Core.html#regex"><code>Core#regex</code></a></li>
</ol>
<p>For other events, a matching <a href="Core.html#on"><code>Core#on</code></a> handler will be called.</p></div>
        
    
</header>

<article>
    <div class="container-overview">
    
        
<div class="section-method">

    
    <h2>Constructor</h2>
    

    <h4 class="name" id="Core"><span class="type-signature"></span>new Core<span class="signature">(api, stats, cmdPrefix, groupId)</span><span class="type-signature"> &rarr; {<a href="Core.html">Core</a>}</span></h4>

    







<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="core.js.html">core.js</a>, <a href="core.js.html#line14">line 14</a>
    </li></ul></dd>
    

    

    

    
</dl>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>api</code></td>
            

            <td class="type">
            
                
<span class="param-type"><code><a href="API.html">API</a></code></span>


            
            </td>

            

            

            <td class="description last">
                <p><code>API</code> object</p>
                
            </td>
        </tr>

    

        <tr>
            
                <td class="name"><code>stats</code></td>
            

            <td class="type">
            
                
<span class="param-type"><code><a href="Stats.html">Stats</a></code></span>


            
            </td>

            

            

            <td class="description last">
                <p>statistics object</p>
                
            </td>
        </tr>

    

        <tr>
            
                <td class="name"><code>cmdPrefix</code></td>
            

            <td class="type">
            
                
<span class="param-type"><code>string</code></span>


            
            </td>

            

            

            <td class="description last">
                <p>command prefix</p>
                
            </td>
        </tr>

    

        <tr>
            
                <td class="name"><code>groupId</code></td>
            

            <td class="type">
            
                
<span class="param-type"><code>string</code></span>
|

<span class="param-type"><code>number</code></span>


            
            </td>

            

            

            <td class="description last">
                <p>group id</p>
                
            </td>
        </tr>

    
    </tbody>
</table>














<div class="section-returns">
<h5>Returns:</h5>

        

<dl class="param-type">
    <dt>
        Type:
    </dt>
    <dd>
        
<span class="param-type"><code><a href="Core.html">Core</a></code></span>


    </dd>
</dl>


    
</div>



</div>
    
    </div>

    

    

    

     

    

    
        <h3 class="subsection-title">Members</h3>

        
            
<div class="section-members">
<h4 class="name" id=".this._cmdPrefix"><span class="type-signature">(private, static) </span>this._cmdPrefix<span class="type-signature"> :string</span></h4>




<div class="description">
    <p>Command prefix</p>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="core.js.html">core.js</a>, <a href="core.js.html#line64">line 64</a>
    </li></ul></dd>
    

    

    

    
</dl>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type"><code>string</code></span>


        </li>
    </ul>





</div>

        
            
<div class="section-members">
<h4 class="name" id=".this._commandHandlers"><span class="type-signature">(private, static) </span>this._commandHandlers<span class="type-signature"> :Array.&lt;Object></span></h4>




<div class="description">
    <p>Command handlers</p>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="core.js.html">core.js</a>, <a href="core.js.html#line143">line 143</a>
    </li></ul></dd>
    

    

    

    
</dl>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type"><code>Array.&lt;Object></code></span>


        </li>
    </ul>





</div>

        
            
<div class="section-members">
<h4 class="name" id=".this._dynPayloadHandlers"><span class="type-signature">(private, static) </span>this._dynPayloadHandlers<span class="type-signature"> :Array.&lt;Object></span></h4>




<div class="description">
    <p>Dynamic payload handlers (those which use functions to determine whether a handler is suitable)</p>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="core.js.html">core.js</a>, <a href="core.js.html#line134">line 134</a>
    </li></ul></dd>
    

    

    

    
</dl>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type"><code>Array.&lt;Object></code></span>


        </li>
    </ul>





</div>

        
            
<div class="section-members">
<h4 class="name" id=".this._escapedCmdPrefix"><span class="type-signature">(private, static) </span>this._escapedCmdPrefix<span class="type-signature"> :string</span></h4>




<div class="description">
    <p>Command prefix, escaped for usage in regular expressions</p>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="core.js.html">core.js</a>, <a href="core.js.html#line73">line 73</a>
    </li></ul></dd>
    

    

    

    
</dl>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type"><code>string</code></span>


        </li>
    </ul>





</div>

        
            
<div class="section-members">
<h4 class="name" id=".this._eventHandlers"><span class="type-signature">(private, static) </span>this._eventHandlers<span class="type-signature"> :Object</span></h4>




<div class="description">
    <p>Handlers for events</p>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="core.js.html">core.js</a>, <a href="core.js.html#line100">line 100</a>
    </li></ul></dd>
    

    

    

    
</dl>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type"><code>Object</code></span>


        </li>
    </ul>





</div>

        
            
<div class="section-members">
<h4 class="name" id=".this._eventWarnings"><span class="type-signature">(private, static) </span>this._eventWarnings<span class="type-signature"> :boolean</span></h4>




<div class="description">
    <p>Are event warnings enabled?</p>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="core.js.html">core.js</a>, <a href="core.js.html#line161">line 161</a>
    </li></ul></dd>
    

    

    

    
</dl>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type"><code>boolean</code></span>


        </li>
    </ul>





</div>

        
            
<div class="section-members">
<h4 class="name" id=".this._exactPayloadHandlers"><span class="type-signature">(private, static) </span>this._exactPayloadHandlers<span class="type-signature"> :Object</span></h4>




<div class="description">
    <p>Exact payload handlers</p>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="core.js.html">core.js</a>, <a href="core.js.html#line125">line 125</a>
    </li></ul></dd>
    

    

    

    
</dl>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type"><code>Object</code></span>


        </li>
    </ul>





</div>

        
            
<div class="section-members">
<h4 class="name" id=".this._groupId"><span class="type-signature">(private, static) </span>this._groupId<span class="type-signature"> :string</span></h4>




<div class="description">
    <p>Group ID</p>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="core.js.html">core.js</a>, <a href="core.js.html#line82">line 82</a>
    </li></ul></dd>
    

    

    

    
</dl>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type"><code>string</code></span>


        </li>
    </ul>





</div>

        
            
<div class="section-members">
<h4 class="name" id=".this._helpMessage"><span class="type-signature">(private, static) </span>this._helpMessage<span class="type-signature"> :string</span></h4>




<div class="description">
    <p>The help message</p>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="core.js.html">core.js</a>, <a href="core.js.html#line170">line 170</a>
    </li></ul></dd>
    

    

    

    
</dl>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type"><code>string</code></span>


        </li>
    </ul>





</div>

        
            
<div class="section-members">
<h4 class="name" id=".this._locked"><span class="type-signature">(private, static) </span>this._locked<span class="type-signature"> :boolean</span></h4>




<div class="description">
    <p>Is this <code>Core</code> locked?</p>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="core.js.html">core.js</a>, <a href="core.js.html#line91">line 91</a>
    </li></ul></dd>
    

    

    

    
</dl>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type"><code>boolean</code></span>


        </li>
    </ul>





</div>

        
            
<div class="section-members">
<h4 class="name" id=".this._regexHandlers"><span class="type-signature">(private, static) </span>this._regexHandlers<span class="type-signature"> :Array.&lt;Object></span></h4>




<div class="description">
    <p>Regular expression handlers</p>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="core.js.html">core.js</a>, <a href="core.js.html#line152">line 152</a>
    </li></ul></dd>
    

    

    

    
</dl>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type"><code>Array.&lt;Object></code></span>


        </li>
    </ul>





</div>

        
            
<div class="section-members">
<h4 class="name" id=".this.api"><span class="type-signature">(static, readonly) </span>this.api<span class="type-signature"> :<a href="API.html">API</a></span></h4>








<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="core.js.html">core.js</a>, <a href="core.js.html#line48">line 48</a>
    </li></ul></dd>
    

    

    

    
</dl>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type"><code><a href="API.html">API</a></code></span>


        </li>
    </ul>





</div>

        
            
<div class="section-members">
<h4 class="name" id=".this.stats"><span class="type-signature">(static, readonly) </span>this.stats<span class="type-signature"> :<a href="Stats.html">Stats</a></span></h4>








<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="core.js.html">core.js</a>, <a href="core.js.html#line55">line 55</a>
    </li></ul></dd>
    

    

    

    
</dl>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type"><code><a href="Stats.html">Stats</a></code></span>


        </li>
    </ul>





</div>

        
    

    
        <h3 class="subsection-title">Methods</h3>

        
            
<div class="section-method">

    

    <h4 class="name" id="_escapeRegex"><span class="type-signature">(private) </span>_escapeRegex<span class="signature">(s)</span><span class="type-signature"> &rarr; {string}</span></h4>

    



<div class="description">
    <p>Escapes a string for usage in regex.</p>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="core.js.html">core.js</a>, <a href="core.js.html#line691">line 691</a>
    </li></ul></dd>
    

    

    

    
</dl>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>s</code></td>
            

            <td class="type">
            
                
<span class="param-type"><code>string</code></span>


            
            </td>

            

            

            <td class="description last">
                <p>string to escape</p>
                
            </td>
        </tr>

    
    </tbody>
</table>














<div class="section-returns">
<h5>Returns:</h5>

        

<dl class="param-type">
    <dt>
        Type:
    </dt>
    <dd>
        
<span class="param-type"><code>string</code></span>


    </dd>
</dl>


<div class="param-desc">
    <p>the escaped string</p>
</div>

    
</div>



</div>
        
            
<div class="section-method">

    

    <h4 class="name" id="_event"><span class="type-signature">(async, private) </span>_event<span class="signature">(name, $)</span><span class="type-signature"></span></h4>

    



<div class="description">
    <p>Handles an event</p>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="core.js.html">core.js</a>, <a href="core.js.html#line487">line 487</a>
    </li></ul></dd>
    

    

    

    
</dl>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>name</code></td>
            

            <td class="type">
            
                
<span class="param-type"><code>string</code></span>


            
            </td>

            

            

            <td class="description last">
                <p>event name</p>
                
            </td>
        </tr>

    

        <tr>
            
                <td class="name"><code>$</code></td>
            

            <td class="type">
            
                
<span class="param-type"><code><a href="Context.html">Context</a></code></span>


            
            </td>

            

            

            <td class="description last">
                <p>context object</p>
                
            </td>
        </tr>

    
    </tbody>
</table>
















</div>
        
            
<div class="section-method">

    

    <h4 class="name" id="_generateHelpMessage"><span class="type-signature">(private) </span>_generateHelpMessage<span class="signature">()</span><span class="type-signature"></span></h4>

    



<div class="description">
    <p>Generates the help message</p>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="core.js.html">core.js</a>, <a href="core.js.html#line647">line 647</a>
    </li></ul></dd>
    

    

    

    
</dl>























</div>
        
            
<div class="section-method">

    

    <h4 class="name" id="_isLocked"><span class="type-signature">(private) </span>_isLocked<span class="signature">()</span><span class="type-signature"> &rarr; {boolean}</span></h4>

    



<div class="description">
    <p>Returns whether this <code>Core</code> is locked, and prints a message
to notify the user if it is locked</p>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="core.js.html">core.js</a>, <a href="core.js.html#line207">line 207</a>
    </li></ul></dd>
    

    

    

    
</dl>





















<div class="section-returns">
<h5>Returns:</h5>

        

<dl class="param-type">
    <dt>
        Type:
    </dt>
    <dd>
        
<span class="param-type"><code>boolean</code></span>


    </dd>
</dl>


<div class="param-desc">
    <p>is this <code>Core</code> locked?</p>
</div>

    
</div>



</div>
        
            
<div class="section-method">

    

    <h4 class="name" id="_registerMessageNewHandler"><span class="type-signature">(private) </span>_registerMessageNewHandler<span class="signature">()</span><span class="type-signature"></span></h4>

    



<div class="description">
    <p>Registers a handler for <code>message_new</code> event</p>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="core.js.html">core.js</a>, <a href="core.js.html#line517">line 517</a>
    </li></ul></dd>
    

    

    

    
</dl>























</div>
        
            
<div class="section-method">

    

    <h4 class="name" id="_tryHandleCommand"><span class="type-signature">(async, private) </span>_tryHandleCommand<span class="signature">($)</span><span class="type-signature"> &rarr; {boolean}</span></h4>

    



<div class="description">
    <p>Tries to handle the message in the given <code>Context</code>
with a command handler</p>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="core.js.html">core.js</a>, <a href="core.js.html#line599">line 599</a>
    </li></ul></dd>
    

    

    

    
</dl>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>$</code></td>
            

            <td class="type">
            
                
<span class="param-type"><code><a href="Context.html">Context</a></code></span>


            
            </td>

            

            

            <td class="description last">
                <p>context object</p>
                
            </td>
        </tr>

    
    </tbody>
</table>














<div class="section-returns">
<h5>Returns:</h5>

        

<dl class="param-type">
    <dt>
        Type:
    </dt>
    <dd>
        
<span class="param-type"><code>boolean</code></span>


    </dd>
</dl>


<div class="param-desc">
    <p>was the message handled?</p>
</div>

    
</div>



</div>
        
            
<div class="section-method">

    

    <h4 class="name" id="_tryHandlePayload"><span class="type-signature">(async, private) </span>_tryHandlePayload<span class="signature">($)</span><span class="type-signature"> &rarr; {boolean}</span></h4>

    



<div class="description">
    <p>Tries to handle the message in the given <code>Context</code>
with a payload handler</p>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="core.js.html">core.js</a>, <a href="core.js.html#line552">line 552</a>
    </li></ul></dd>
    

    

    

    
</dl>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>$</code></td>
            

            <td class="type">
            
                
<span class="param-type"><code><a href="Context.html">Context</a></code></span>


            
            </td>

            

            

            <td class="description last">
                <p>context object</p>
                
            </td>
        </tr>

    
    </tbody>
</table>














<div class="section-returns">
<h5>Returns:</h5>

        

<dl class="param-type">
    <dt>
        Type:
    </dt>
    <dd>
        
<span class="param-type"><code>boolean</code></span>


    </dd>
</dl>


<div class="param-desc">
    <p>was the message handled?</p>
</div>

    
</div>



</div>
        
            
<div class="section-method">

    

    <h4 class="name" id="_tryHandleRegex"><span class="type-signature">(async, private) </span>_tryHandleRegex<span class="signature">($)</span><span class="type-signature"> &rarr; {boolean}</span></h4>

    



<div class="description">
    <p>Tries to handle the message in the given <code>Context</code>
with a regex handler</p>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="core.js.html">core.js</a>, <a href="core.js.html#line628">line 628</a>
    </li></ul></dd>
    

    

    

    
</dl>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>$</code></td>
            

            <td class="type">
            
                
<span class="param-type"><code><a href="Context.html">Context</a></code></span>


            
            </td>

            

            

            <td class="description last">
                <p>context object</p>
                
            </td>
        </tr>

    
    </tbody>
</table>














<div class="section-returns">
<h5>Returns:</h5>

        

<dl class="param-type">
    <dt>
        Type:
    </dt>
    <dd>
        
<span class="param-type"><code>boolean</code></span>


    </dd>
</dl>


<div class="param-desc">
    <p>was the message handled?</p>
</div>

    
</div>



</div>
        
            
<div class="section-method">

    

    <h4 class="name" id="cmd"><span class="type-signature"></span>cmd<span class="signature">(command, callback, description<span class="signature-attributes">opt</span>)</span><span class="type-signature"></span></h4>

    



<div class="description">
    <p>Registers a command handler</p>
<p>Handler is called if the message begins with <code>cmd_prefix</code> (defined in the parameters) <strong>+</strong> <code>command</code></p>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="core.js.html">core.js</a>, <a href="core.js.html#line418">line 418</a>
    </li></ul></dd>
    

    

    

    
</dl>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        
        <th>Default</th>
        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>command</code></td>
            

            <td class="type">
            
                
<span class="param-type"><code>string</code></span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last">
                <p>command</p>
                
            </td>
        </tr>

    

        <tr>
            
                <td class="name"><code>callback</code></td>
            

            <td class="type">
            
                
<span class="param-type"><code><a href="global.html#handler">handler</a></code></span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last">
                <p>function, which will handle the message</p>
                
            </td>
        </tr>

    

        <tr>
            
                <td class="name"><code>description</code></td>
            

            <td class="type">
            
                
<span class="param-type"><code>string</code></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    ""
                
                </td>
            

            <td class="description last">
                <p>the description of what this command does, to be used in help messages</p>
                
            </td>
        </tr>

    
    </tbody>
</table>
















<div class="section-examples">
<h5>Example</h5>

    <pre class="prettyprint"><code>core.cmd('help', $ => {
  // core.help() returns the help message
  $.text('Test Bot' + core.help())
}, 'shows the help message')</code></pre>

</div>

</div>
        
            
<div class="section-method">

    

    <h4 class="name" id="help"><span class="type-signature"></span>help<span class="signature">()</span><span class="type-signature"> &rarr; {string}</span></h4>

    



<div class="description">
    <p>Returns the help message</p>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="core.js.html">core.js</a>, <a href="core.js.html#line675">line 675</a>
    </li></ul></dd>
    

    

    

    
</dl>





















<div class="section-returns">
<h5>Returns:</h5>

        

<dl class="param-type">
    <dt>
        Type:
    </dt>
    <dd>
        
<span class="param-type"><code>string</code></span>


    </dd>
</dl>


<div class="param-desc">
    <p>the help message</p>
</div>

    
</div>



</div>
        
            
<div class="section-method">

    

    <h4 class="name" id="lock"><span class="type-signature"></span>lock<span class="signature">()</span><span class="type-signature"></span></h4>

    



<div class="description">
    <p>Locks this <code>Core</code>, so new handlers can't be added,
and generates the help message for later usage</p>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="core.js.html">core.js</a>, <a href="core.js.html#line192">line 192</a>
    </li></ul></dd>
    

    

    

    
</dl>























</div>
        
            
<div class="section-method">

    

    <h4 class="name" id="noEventWarnings"><span class="type-signature"></span>noEventWarnings<span class="signature">()</span><span class="type-signature"></span></h4>

    



<div class="description">
    <p>Disables warnings about missing event handlers</p>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="core.js.html">core.js</a>, <a href="core.js.html#line180">line 180</a>
    </li></ul></dd>
    

    

    

    
</dl>























</div>
        
            
<div class="section-method">

    

    <h4 class="name" id="on"><span class="type-signature"></span>on<span class="signature">(event, callback)</span><span class="type-signature"></span></h4>

    



<div class="description">
    <p>Registers an event handler</p>
<p>Does not work for <code>message_new</code>, as its handler is defined by <code>vk-chat-bot</code> itself.</p>
<h3>Events</h3><h4>Callback API Events</h4><table>
<thead>
<tr>
<th>Event</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>message_allow</code></td>
<td>User <strong>allowed</strong> sending messages to him/her</td>
</tr>
<tr>
<td><code>message_deny</code></td>
<td>User <strong>disallowed</strong> sending messages to him/her</td>
</tr>
<tr>
<td><code>message_reply</code></td>
<td>New <strong>message sent</strong> by community administrator (or by the bot itself)</td>
</tr>
<tr>
<td><code>message_edit</code></td>
<td><strong>Message edited</strong> by user</td>
</tr>
<tr>
<td><code>message_typing_state</code></td>
<td><strong>User is typing</strong> a message</td>
</tr>
</tbody>
</table>
<h4>Other Events</h4><table>
<thead>
<tr>
<th>Event type</th>
<th>When handler is called</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>start</code></td>
<td>If the message's payload is <code>{&quot;command&quot;: &quot;start&quot;}</code> (when user presses the <code>Start</code> button)</td>
</tr>
<tr>
<td><code>service_action</code></td>
<td>Service action message received</td>
</tr>
<tr>
<td><code>no_match</code></td>
<td>When no matching <code>cmd()</code> or <code>regex()</code> handler is found</td>
</tr>
<tr>
<td><code>handler_error</code></td>
<td>If an error is thrown in a handler</td>
</tr>
</tbody>
</table>
<h4>The <code>service_action</code> event</h4><blockquote>
<p>The <code>$.obj.action</code> object contains information about the service action.
It contains the following fields:</p>
</blockquote>
<pre class="prettyprint source"><code>type (string) — action type, one of:
   `chat_photo_update` — chat photo updated
   `chat_photo_remove` — chat photo removed
   `chat_create` — chat created
   `chat_title_update` — chat title updated
   `chat_invite_user` — user was invited to chat
   `chat_kick_user` — user was kicked from the chat
   `chat_pin_message` — a message was pinned
   `chat_unpin_message` — a message was unpinned
   `chat_invite_user_by_link` — user joined the chat by link

member_id (integer):
  user id (if > 0), which was invited or kicked (if &lt; 0, see `email` field)
    (`chat_invite_user`, `chat_invite_user_by_link`,  `chat_kick_user`)
  user id, which pinned or unpinned a message
    (`chat_pin_message`, `chat_unpin_message`)

text (string):
  chat name
    (`chat_create`, `chat_title_update`)

email (string):
  email, which was invited or kicked
    (`chat_invite_user`, `chat_kick_user`, member_id &lt; 0)

photo (object) — chat picture, contains:
    photo_50 (string): URL of image 50 x 50 px
    photo_100 (string): URL of image 100 x 100 px
    photo_200 (string): URL of image 200 x 200 px</code></pre>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="core.js.html">core.js</a>, <a href="core.js.html#line294">line 294</a>
    </li></ul></dd>
    

    

    

    
</dl>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>event</code></td>
            

            <td class="type">
            
                
<span class="param-type"><code>string</code></span>


            
            </td>

            

            

            <td class="description last">
                <p>event name</p>
                
            </td>
        </tr>

    

        <tr>
            
                <td class="name"><code>callback</code></td>
            

            <td class="type">
            
                
<span class="param-type"><code><a href="global.html#handler">handler</a></code></span>


            
            </td>

            

            

            <td class="description last">
                <p>function, which will handle the message</p>
                
            </td>
        </tr>

    
    </tbody>
</table>
















<div class="section-examples">
<h5>Example</h5>

    <pre class="prettyprint"><code>core.on('no_match', $ => {
  $.text('I don\'t know how to respond to your message.')
})</code></pre>

</div>

</div>
        
            
<div class="section-method">

    

    <h4 class="name" id="parseRequest"><span class="type-signature">(async) </span>parseRequest<span class="signature">(body)</span><span class="type-signature"></span></h4>

    



<div class="description">
    <p>Parses the request, creates a <code>Context</code>, and proceeds
to call <code>Core#event</code> to handle the event</p>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="core.js.html">core.js</a>, <a href="core.js.html#line469">line 469</a>
    </li></ul></dd>
    

    

    

    
</dl>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>body</code></td>
            

            <td class="type">
            
                
<span class="param-type"><code>Object</code></span>


            
            </td>

            

            

            <td class="description last">
                <p>body of the request, in parsed JSON</p>
                
            </td>
        </tr>

    
    </tbody>
</table>
















</div>
        
            
<div class="section-method">

    

    <h4 class="name" id="payload"><span class="type-signature"></span>payload<span class="signature">(payload, callback)</span><span class="type-signature"></span></h4>

    



<div class="description">
    <p>Registers a payload handler</p>
<p><strong>Note</strong>: exact handlers are searched first, and only if they don't match, the search for a dynamic handler begins.</p>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="core.js.html">core.js</a>, <a href="core.js.html#line375">line 375</a>
    </li></ul></dd>
    

    

    

    
</dl>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>payload</code></td>
            

            <td class="type">
            
                
<span class="param-type"><code>Object</code></span>
|

<span class="param-type"><code><a href="global.html#payload_tester">payload_tester</a></code></span>


            
            </td>

            

            

            <td class="description last">
                <p>exact payload to handle, or a function which will determine whether to handle the payload or not</p>
                
            </td>
        </tr>

    

        <tr>
            
                <td class="name"><code>callback</code></td>
            

            <td class="type">
            
                
<span class="param-type"><code><a href="global.html#handler">handler</a></code></span>


            
            </td>

            

            

            <td class="description last">
                <p>function, which will handle the message</p>
                
            </td>
        </tr>

    
    </tbody>
</table>
















<div class="section-examples">
<h5>Example</h5>

    <pre class="prettyprint"><code>// -------> KEYBOARD (for sending the payload)

// Create a keyboard
var Keyboard = vk.kbd.Keyboard
var Button = vk.kbd.Button
var colors = vk.kbd.colors

var kbd = new Keyboard([[
     // Clicking on this button will send the payload {a: 'b'}
     new Button('Test 1', colors.default, {a: 'b'}),
     new Button('Test 2', colors.default, {a: 'b', c: 'd'})
]], false)

// When asked, send the keyboard
core.regex(/keyboard/i, $ => {
   $.keyboard(kbd)
   $.text('Here it is!')
})

// -------> EXACT PAYLOAD
core.payload({a: 'b'}, $ => {
   $.text('Received secret payload!')
})

// -------> DYNAMIC PAYLOAD
// In this case, the handler will run only if the
// payload's property `c` contains the value `d`.
core.payload((payload, parsed) => {
   if (parsed) { // If the payload is a valid JSON
     return parsed.c === 'd'
   } else {
     return false
   }
}, $ => {
   $.text(`In message '${$.msg}', payload.c is 'd'!`)
})</code></pre>

</div>

</div>
        
            
<div class="section-method">

    

    <h4 class="name" id="regex"><span class="type-signature"></span>regex<span class="signature">(regex, callback)</span><span class="type-signature"></span></h4>

    



<div class="description">
    <p>Registers a regex handler</p>
</div>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="core.js.html">core.js</a>, <a href="core.js.html#line446">line 446</a>
    </li></ul></dd>
    

    

    

    
</dl>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>regex</code></td>
            

            <td class="type">
            
                
<span class="param-type"><code>RegExp</code></span>


            
            </td>

            

            

            <td class="description last">
                <p>regular expression</p>
                
            </td>
        </tr>

    

        <tr>
            
                <td class="name"><code>callback</code></td>
            

            <td class="type">
            
                
<span class="param-type"><code><a href="global.html#handler">handler</a></code></span>


            
            </td>

            

            

            <td class="description last">
                <p>function, which will handle the message</p>
                
            </td>
        </tr>

    
    </tbody>
</table>
















<div class="section-examples">
<h5>Example</h5>

    <pre class="prettyprint"><code>core.regex(/h(i|ello|ey)/i, $ => {
   $.text('Hello, I am a test bot. You said: ' + $.msg)
})</code></pre>

</div>

</div>
        
    

    

    
</article>

</section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>